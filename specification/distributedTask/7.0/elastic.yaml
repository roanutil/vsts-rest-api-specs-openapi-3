openapi: 3.0.1
info:
  title: Elastic
  description: ""
  termsOfService: https://go.microsoft.com/fwlink/?LinkId=329770
  contact:
    name: nugetvss
    email: nugetvss@microsoft.com
  license:
    name: MICROSOFT SOFTWARE LICENSE TERMS
    url: https://go.microsoft.com/fwlink/?LinkId=329770
  version: "7.0"
externalDocs:
  description: Azure DevOps REST APIs
  url: https://aka.ms/azure-devops-rest-apis
servers:
- url: https://dev.azure.com/
security:
- accessToken: []
tags:
- name: Elasticpoollogs
  description: Controller to handle organization/collection level elastic pool logs
    operations
- name: Elasticpools
  description: Controller to handle organization/collection level elastic pool operations
- name: Nodes
  description: Controller to handle organization/collection level elastic node operations
paths:
  /{organization}/_apis/distributedtask/elasticpools:
    get:
      tags:
      - Elasticpools
      description: Get a list of all Elastic Pools.
      operationId: Elasticpools_List
      parameters:
      - name: organization
        in: path
        description: The name of the Azure DevOps organization.
        required: true
        schema:
          type: string
      - name: api-version
        in: query
        description: Version of the API to use.  This should be set to '7.0' to use
          this version of the api.
        required: true
        schema:
          type: string
      responses:
        200:
          description: successful operation
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/ElasticPool'
      x-ms-docs-override-version: "7.0"
      x-ms-vss-resource: elasticpools
      x-ms-vss-method: GetElasticPools
    post:
      tags:
      - Elasticpools
      description: Create a new elastic pool. This will create a new TaskAgentPool
        at the organization level. If a project id is provided, this will create a
        new TaskAgentQueue in the specified project.
      operationId: Elasticpools_Create
      parameters:
      - name: organization
        in: path
        description: The name of the Azure DevOps organization.
        required: true
        schema:
          type: string
      - name: poolName
        in: query
        description: Name to use for the new TaskAgentPool
        required: true
        schema:
          type: string
      - name: authorizeAllPipelines
        in: query
        description: Setting to determine if all pipelines are authorized to use this
          TaskAgentPool by default.
        schema:
          type: boolean
      - name: autoProvisionProjectPools
        in: query
        description: Setting to automatically provision TaskAgentQueues in every project
          for the new pool.
        schema:
          type: boolean
      - name: projectId
        in: query
        description: 'Optional: If provided, a new TaskAgentQueue will be created
          in the specified project.'
        schema:
          type: string
          format: uuid
      - name: api-version
        in: query
        description: Version of the API to use.  This should be set to '7.0' to use
          this version of the api.
        required: true
        schema:
          type: string
      requestBody:
        description: Elastic pool to create. Contains the properties necessary for
          configuring a new ElasticPool.
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ElasticPool'
        required: true
      responses:
        200:
          description: successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ElasticPoolCreationResult'
      x-ms-docs-override-version: "7.0"
      x-ms-vss-resource: elasticpools
      x-ms-vss-method: CreateElasticPool
      x-codegen-request-body-name: body
  /{organization}/_apis/distributedtask/elasticpools/{poolId}:
    get:
      tags:
      - Elasticpools
      description: Returns the Elastic Pool with the specified Pool Id.
      operationId: Elasticpools_Get
      parameters:
      - name: organization
        in: path
        description: The name of the Azure DevOps organization.
        required: true
        schema:
          type: string
      - name: poolId
        in: path
        description: Pool Id of the associated TaskAgentPool
        required: true
        schema:
          type: integer
          format: int32
      - name: api-version
        in: query
        description: Version of the API to use.  This should be set to '7.0' to use
          this version of the api.
        required: true
        schema:
          type: string
      responses:
        200:
          description: successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ElasticPool'
      x-ms-docs-override-version: "7.0"
      x-ms-vss-resource: elasticpools
      x-ms-vss-method: GetElasticPool
    patch:
      tags:
      - Elasticpools
      description: Update settings on a specified Elastic Pool.
      operationId: Elasticpools_Update
      parameters:
      - name: organization
        in: path
        description: The name of the Azure DevOps organization.
        required: true
        schema:
          type: string
      - name: poolId
        in: path
        required: true
        schema:
          type: integer
          format: int32
      - name: api-version
        in: query
        description: Version of the API to use.  This should be set to '7.0' to use
          this version of the api.
        required: true
        schema:
          type: string
      requestBody:
        description: New Elastic Pool settings data
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ElasticPoolSettings'
        required: true
      responses:
        200:
          description: successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ElasticPool'
      x-ms-docs-override-version: "7.0"
      x-ms-vss-resource: elasticpools
      x-ms-vss-method: UpdateElasticPool
      x-codegen-request-body-name: body
  /{organization}/_apis/distributedtask/elasticpools/{poolId}/logs:
    get:
      tags:
      - Elasticpoollogs
      description: Get elastic pool diagnostics logs for a specified Elastic Pool.
      operationId: Elasticpoollogs_List
      parameters:
      - name: organization
        in: path
        description: The name of the Azure DevOps organization.
        required: true
        schema:
          type: string
      - name: poolId
        in: path
        description: Pool Id of the Elastic Pool
        required: true
        schema:
          type: integer
          format: int32
      - name: $top
        in: query
        description: Number of elastic pool logs to retrieve
        schema:
          type: integer
          format: int32
      - name: api-version
        in: query
        description: Version of the API to use.  This should be set to '7.0' to use
          this version of the api.
        required: true
        schema:
          type: string
      responses:
        200:
          description: successful operation
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/ElasticPoolLog'
      x-ms-docs-override-version: "7.0"
      x-ms-vss-resource: elasticpoollogs
      x-ms-vss-method: GetElasticPoolLogs
  /{organization}/_apis/distributedtask/elasticpools/{poolId}/nodes:
    get:
      tags:
      - Nodes
      description: Get a list of ElasticNodes currently in the ElasticPool
      operationId: Nodes_List
      parameters:
      - name: organization
        in: path
        description: The name of the Azure DevOps organization.
        required: true
        schema:
          type: string
      - name: poolId
        in: path
        description: Pool id of the ElasticPool
        required: true
        schema:
          type: integer
          format: int32
      - name: $state
        in: query
        description: 'Optional: Filter to only retrieve ElasticNodes in the given
          ElasticNodeState'
        schema:
          type: string
          enum:
          - none
          - new
          - creatingCompute
          - startingAgent
          - idle
          - assigned
          - offline
          - pendingReimage
          - pendingDelete
          - saved
          - deletingCompute
          - deleted
          - lost
          x-ms-enum:
            name: ElasticNodeState
            values:
            - value: none
              description: ""
            - value: new
              description: ""
            - value: creatingCompute
              description: ""
            - value: startingAgent
              description: ""
            - value: idle
              description: ""
            - value: assigned
              description: ""
            - value: offline
              description: ""
            - value: pendingReimage
              description: ""
            - value: pendingDelete
              description: ""
            - value: saved
              description: ""
            - value: deletingCompute
              description: ""
            - value: deleted
              description: ""
            - value: lost
              description: ""
        x-ms-enum:
          name: ElasticNodeState
          values:
          - value: none
            description: ""
          - value: new
            description: ""
          - value: creatingCompute
            description: ""
          - value: startingAgent
            description: ""
          - value: idle
            description: ""
          - value: assigned
            description: ""
          - value: offline
            description: ""
          - value: pendingReimage
            description: ""
          - value: pendingDelete
            description: ""
          - value: saved
            description: ""
          - value: deletingCompute
            description: ""
          - value: deleted
            description: ""
          - value: lost
            description: ""
      - name: api-version
        in: query
        description: Version of the API to use.  This should be set to '7.0' to use
          this version of the api.
        required: true
        schema:
          type: string
      responses:
        200:
          description: successful operation
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/ElasticNode'
      x-ms-docs-override-version: "7.0"
      x-ms-vss-resource: nodes
      x-ms-vss-method: GetElasticNodes
  /{organization}/_apis/distributedtask/elasticpools/{poolId}/nodes/{elasticNodeId}:
    patch:
      tags:
      - Nodes
      description: Update properties on a specified ElasticNode
      operationId: Nodes_Update
      parameters:
      - name: organization
        in: path
        description: The name of the Azure DevOps organization.
        required: true
        schema:
          type: string
      - name: poolId
        in: path
        required: true
        schema:
          type: integer
          format: int32
      - name: elasticNodeId
        in: path
        required: true
        schema:
          type: integer
          format: int32
      - name: api-version
        in: query
        description: Version of the API to use.  This should be set to '7.0' to use
          this version of the api.
        required: true
        schema:
          type: string
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ElasticNodeSettings'
        required: true
      responses:
        200:
          description: successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ElasticNode'
      x-ms-docs-override-version: "7.0"
      x-ms-vss-resource: nodes
      x-ms-vss-method: UpdateElasticNode
      x-codegen-request-body-name: body
components:
  schemas:
    ElasticNode:
      type: object
      properties:
        agentId:
          type: integer
          description: Distributed Task's Agent Id
          format: int32
        agentState:
          type: string
          description: Summary of the state of the agent
          enum:
          - none
          - enabled
          - online
          - assigned
          x-ms-enum:
            name: ElasticAgentState
            values:
            - value: none
              description: ""
            - value: enabled
              description: ""
            - value: online
              description: ""
            - value: assigned
              description: ""
        computeId:
          type: string
          description: Compute Id.  VMSS's InstanceId
        computeState:
          type: string
          description: State of the compute host
          enum:
          - none
          - healthy
          - creating
          - deleting
          - failed
          - stopped
          x-ms-enum:
            name: ElasticComputeState
            values:
            - value: none
              description: ""
            - value: healthy
              description: ""
            - value: creating
              description: ""
            - value: deleting
              description: ""
            - value: failed
              description: ""
            - value: stopped
              description: ""
        desiredState:
          type: string
          description: Users can force state changes to specific states (ToReimage,
            ToDelete, Save)
          enum:
          - none
          - new
          - creatingCompute
          - startingAgent
          - idle
          - assigned
          - offline
          - pendingReimage
          - pendingDelete
          - saved
          - deletingCompute
          - deleted
          - lost
          x-ms-enum:
            name: ElasticNodeState
            values:
            - value: none
              description: ""
            - value: new
              description: ""
            - value: creatingCompute
              description: ""
            - value: startingAgent
              description: ""
            - value: idle
              description: ""
            - value: assigned
              description: ""
            - value: offline
              description: ""
            - value: pendingReimage
              description: ""
            - value: pendingDelete
              description: ""
            - value: saved
              description: ""
            - value: deletingCompute
              description: ""
            - value: deleted
              description: ""
            - value: lost
              description: ""
        id:
          type: integer
          description: Unique identifier since the agent and/or VM may be null
          format: int32
        name:
          type: string
          description: Computer name. Used to match a scaleset VM with an agent
        poolId:
          type: integer
          description: Pool Id that this node belongs to
          format: int32
        requestId:
          type: integer
          description: Last job RequestId assigned to this agent
          format: int64
        state:
          type: string
          description: State of the ElasticNode
          enum:
          - none
          - new
          - creatingCompute
          - startingAgent
          - idle
          - assigned
          - offline
          - pendingReimage
          - pendingDelete
          - saved
          - deletingCompute
          - deleted
          - lost
          x-ms-enum:
            name: ElasticNodeState
            values:
            - value: none
              description: ""
            - value: new
              description: ""
            - value: creatingCompute
              description: ""
            - value: startingAgent
              description: ""
            - value: idle
              description: ""
            - value: assigned
              description: ""
            - value: offline
              description: ""
            - value: pendingReimage
              description: ""
            - value: pendingDelete
              description: ""
            - value: saved
              description: ""
            - value: deletingCompute
              description: ""
            - value: deleted
              description: ""
            - value: lost
              description: ""
        stateChangedOn:
          type: string
          description: Last state change. Only updated by SQL.
          format: date-time
      description: Data and settings for an elastic node
    ElasticNodeSettings:
      type: object
      properties:
        state:
          type: string
          description: State of the ElasticNode
          enum:
          - none
          - new
          - creatingCompute
          - startingAgent
          - idle
          - assigned
          - offline
          - pendingReimage
          - pendingDelete
          - saved
          - deletingCompute
          - deleted
          - lost
          x-ms-enum:
            name: ElasticNodeState
            values:
            - value: none
              description: ""
            - value: new
              description: ""
            - value: creatingCompute
              description: ""
            - value: startingAgent
              description: ""
            - value: idle
              description: ""
            - value: assigned
              description: ""
            - value: offline
              description: ""
            - value: pendingReimage
              description: ""
            - value: pendingDelete
              description: ""
            - value: saved
              description: ""
            - value: deletingCompute
              description: ""
            - value: deleted
              description: ""
            - value: lost
              description: ""
      description: Class used for updating an elastic node where only certain members
        are populated
    ElasticPool:
      type: object
      properties:
        agentInteractiveUI:
          type: boolean
          description: Set whether agents should be configured to run with interactive
            UI
        azureId:
          type: string
          description: Azure string representing to location of the resource
        desiredIdle:
          type: integer
          description: Number of agents to have ready waiting for jobs
          format: int32
        desiredSize:
          type: integer
          description: The desired size of the pool
          format: int32
        maxCapacity:
          type: integer
          description: Maximum number of nodes that will exist in the elastic pool
          format: int32
        maxSavedNodeCount:
          type: integer
          description: Keep nodes in the pool on failure for investigation
          format: int32
        offlineSince:
          type: string
          description: Timestamp the pool was first detected to be offline
          format: date-time
        osType:
          type: string
          description: Operating system type of the nodes in the pool
          enum:
          - windows
          - linux
          x-ms-enum:
            name: OperatingSystemType
            values:
            - value: windows
              description: ""
            - value: linux
              description: ""
        poolId:
          type: integer
          description: Id of the associated TaskAgentPool
          format: int32
        recycleAfterEachUse:
          type: boolean
          description: Discard node after each job completes
        serviceEndpointId:
          type: string
          description: Id of the Service Endpoint used to connect to Azure
          format: uuid
        serviceEndpointScope:
          type: string
          description: Scope the Service Endpoint belongs to
          format: uuid
        sizingAttempts:
          type: integer
          description: The number of sizing attempts executed while trying to achieve
            a desired size
          format: int32
        state:
          type: string
          description: State of the pool
          enum:
          - online
          - offline
          - unhealthy
          - new
          x-ms-enum:
            name: ElasticPoolState
            values:
            - value: online
              description: Online and healthy
            - value: offline
              description: ""
            - value: unhealthy
              description: ""
            - value: new
              description: ""
        timeToLiveMinutes:
          type: integer
          description: The minimum time in minutes to keep idle agents alive
          format: int32
      description: Data and settings for an elastic pool
    ElasticPoolCreationResult:
      type: object
      properties:
        agentPool:
          $ref: '#/components/schemas/TaskAgentPool'
        agentQueue:
          $ref: '#/components/schemas/TaskAgentQueue'
        elasticPool:
          $ref: '#/components/schemas/ElasticPool'
      description: Returned result from creating a new elastic pool
    ElasticPoolLog:
      type: object
      properties:
        id:
          type: integer
          description: Log Id
          format: int64
        level:
          type: string
          description: E.g. error, warning, info
          enum:
          - error
          - warning
          - info
          x-ms-enum:
            name: LogLevel
            values:
            - value: error
              description: ""
            - value: warning
              description: ""
            - value: info
              description: ""
        message:
          type: string
          description: Log contents
        operation:
          type: string
          description: Operation that triggered the message being logged
          enum:
          - configurationJob
          - sizingJob
          - increaseCapacity
          - reimage
          - deleteVMs
          x-ms-enum:
            name: OperationType
            values:
            - value: configurationJob
              description: ""
            - value: sizingJob
              description: ""
            - value: increaseCapacity
              description: ""
            - value: reimage
              description: ""
            - value: deleteVMs
              description: ""
        poolId:
          type: integer
          description: Id of the associated TaskAgentPool
          format: int32
        timestamp:
          type: string
          description: Datetime that the log occurred
          format: date-time
      description: Log data for an Elastic Pool
    ElasticPoolSettings:
      type: object
      properties:
        agentInteractiveUI:
          type: boolean
          description: Set whether agents should be configured to run with interactive
            UI
        azureId:
          type: string
          description: Azure string representing to location of the resource
        desiredIdle:
          type: integer
          description: Number of machines to have ready waiting for jobs
          format: int32
        maxCapacity:
          type: integer
          description: Maximum number of machines that will exist in the elastic pool
          format: int32
        maxSavedNodeCount:
          type: integer
          description: Keep machines in the pool on failure for investigation
          format: int32
        osType:
          type: string
          description: Operating system type of the machines in the pool
          enum:
          - windows
          - linux
          x-ms-enum:
            name: OperatingSystemType
            values:
            - value: windows
              description: ""
            - value: linux
              description: ""
        recycleAfterEachUse:
          type: boolean
          description: Discard machines after each job completes
        serviceEndpointId:
          type: string
          description: Id of the Service Endpoint used to connect to Azure
          format: uuid
        serviceEndpointScope:
          type: string
          description: Scope the Service Endpoint belongs to
          format: uuid
        timeToLiveMinutes:
          type: integer
          description: The minimum time in minutes to keep idle agents alive
          format: int32
      description: Class used for updating an elastic pool where only certain members
        are populated
    GraphSubjectBase:
      type: object
      properties:
        _links:
          $ref: '#/components/schemas/ReferenceLinks'
        descriptor:
          type: string
          description: The descriptor is the primary way to reference the graph subject
            while the system is running. This field will uniquely identify the same
            graph subject across both Accounts and Organizations.
        displayName:
          type: string
          description: This is the non-unique display name of the graph subject. To
            change this field, you must alter its value in the source provider.
        url:
          type: string
          description: This url is the full route to the source resource of this graph
            subject.
      description: ""
    IdentityRef:
      description: ""
      allOf:
      - $ref: '#/components/schemas/GraphSubjectBase'
    PropertiesCollection:
      type: object
      properties:
        count:
          type: integer
          description: The count of properties in the collection.
          format: int32
        item:
          type: object
          properties: {}
        keys:
          type: array
          description: The set of keys in the collection.
          items:
            type: string
        values:
          type: array
          description: The set of values in the collection.
          items:
            type: string
      description: The class represents a property bag as a collection of key-value
        pairs. Values of all primitive types (any type with a `TypeCode != TypeCode.Object`)
        except for `DBNull` are accepted. Values of type Byte[], Int32, Double, DateType
        and String preserve their type, other primitives are retuned as a String.
        Byte[] expected as base64 encoded string.
    ReferenceLinks:
      type: object
      properties:
        links:
          type: object
          additionalProperties:
            type: object
            properties: {}
          description: The readonly view of the links.  Because Reference links are
            readonly, we only want to expose them as read only.
      description: The class to represent a collection of REST reference links.
    TaskAgentPool:
      description: An organization-level grouping of agents.
      allOf:
      - $ref: '#/components/schemas/TaskAgentPoolReference'
    TaskAgentPoolReference:
      type: object
      properties:
        id:
          type: integer
          format: int32
        isHosted:
          type: boolean
          description: Gets or sets a value indicating whether or not this pool is
            managed by the service.
        isLegacy:
          type: boolean
          description: Determines whether the pool is legacy.
        name:
          type: string
        options:
          type: string
          description: Additional pool settings and details
          enum:
          - none
          - elasticPool
          - singleUseAgents
          - preserveAgentOnJobFailure
          x-ms-enum:
            name: TaskAgentPoolOptions
            values:
            - value: none
              description: ""
            - value: elasticPool
              description: TaskAgentPool backed by the Elastic pool service
            - value: singleUseAgents
              description: Set to true if agents are re-imaged after each TaskAgentJobRequest
            - value: preserveAgentOnJobFailure
              description: Set to true if agents are held for investigation after
                a TaskAgentJobRequest failure
        poolType:
          type: string
          description: Gets or sets the type of the pool
          enum:
          - automation
          - deployment
          x-ms-enum:
            name: TaskAgentPoolType
            values:
            - value: automation
              description: A typical pool of task agents
            - value: deployment
              description: A deployment pool
        scope:
          type: string
          format: uuid
        size:
          type: integer
          description: Gets the current size of the pool.
          format: int32
      description: ""
    TaskAgentQueue:
      type: object
      properties:
        id:
          type: integer
          description: ID of the queue
          format: int32
        name:
          type: string
          description: Name of the queue
        pool:
          $ref: '#/components/schemas/TaskAgentPoolReference'
        projectId:
          type: string
          description: Project ID
          format: uuid
      description: An agent queue.
  parameters:
    api-Version:
      name: api-version
      in: query
      description: Version of the API to use.  This should be set to '7.0' to use
        this version of the api.
      required: true
      schema:
        type: string
  securitySchemes:
    accessToken:
      type: http
      description: Personal access token. Use any value for the user name and the
        token as the password.
      scheme: basic
x-ms-vss-area: Elastic
